**Надстройка для класса по работе с Бизнес РУ**

Данная надстройка упрощяет  работу с такой "приятной системой" как Бизнес РУ. Обо всём по порядку.  
На момент написания доккументации надстройка умеет создавать только Сделки.  
Кракая инстукция и описание методов.

1. Вы должны зайти в свой личный кабинет Бизнес ру перейти по url типа https://exemple.class365.ru/externalapplication там вы должены создать ключ для работы с API проекта
, там же вы получите идентификатор интеграции. 
2. Выбрав пункт CRM->Сделка или слева вверху создайте новую сделку, сразу пропишите нужные доп поля,  руками выберие отвественного мененджера.

3. Теперь можно приступить к ознакомлению с методами класса.

***ВНИМАНИЕ API РАБОТАЕТ ТОЛЬКО С КОДИРОВКОЙ UTF-8***  
Сначала создаем экземпляр класса.
```
$business = new Business(1234, '647457457547', 'https://exemple.class365.ru');
```
* 1ый параметр - это идентификатор интеграции который вы получили в пункте 1.
* 2ой параметр - API ключь  который вы получили в пункте 1. 
* 3ий параметр - url вашего домена  он должен быть как в примере (на конце не 
должно быть слешка, содержать хттпс)
 
После создания экземпляра класса вы можете приступить к созданию Контрагента(клиента) 

```
$business->newPartner($name, ['1' => '+711111111111', '4' => 'mail@yandex.ru']);
```

* 1ый параметр Имя Контакта(клиента).
* 2ой параметр - массив  (смотри подробнее ниже) содержащий номер телефона и  email

Список ID  соотношение ид с видом связи.
```
[id] =>   1[name]  => Телефон,         [id] =>  2[name]  => Skype,
[id] =>   3[name]  => Адрес,           [id] =>  4[name]  => Email,
[id] =>   5[name]  => Прочее,          [id] =>  6[name]  => Сайт,
[id] =>   7[name]  => ICQ,             [id] =>  8[name]  => Вконтакте,
[id] =>   9[name]  => Facebook,        [id] =>  10[name] => Twitter,
[id] =>  11[name] => Одноклассники
```
Этот же список есть в самом классе Business , достаточно его открыть он в самом начале(сделано для вашего удобства)

Функция `newPartner()` проверяет так же на  то ,есть ли данный контакт в системе, если он уже есть,  
то  не создает новый контакт, так же добавляет недостающие данные например Skype или ICQ.

После создания Партнера  создаём сделку.
```
$options['author_employee_id']      = 282811;
$options['responsible_employee_id'] = 282811;
$options['organization_id']         = 75535;
$options['name']                    = ("Заявка с формы Обратная связь сайта exemple.com");
$options['executor_employee_id']    = 87410;
$options['description']             = 'Описание ';
$options['326157']                  = "Обратная связь сайта exemple.com";
$options['326155']                  = $roistatVisit;
$options['326543']                  = date("Y-m-d H");
$business->newDeal($options);
```
Обо всех параметрах
* 1ый параметр автор  Сделки , его нужно смотреть вручную (подробнее ниже)
* 2ой параметр отвественный автор( я не до конца понял что это, подробнее где взять ниже)
* 3ий параметр организатор (подробнее где посмотреть ниже)
* 4ый параметр название сделки
* 5ый параметр отвественный мененджер за сделку (где смотреть ниже)
* 6ой параметр Описание сделки
* 7-9 параметр   доп поля (где смотреть ниже)

Обязательными параметрами являются с 1 по 4 без них сделка не создастся

Теперь о том как получить  дополнительные поля и ID которые нужны
Нужно выполнить следующую функцию и вывести её результат.
```
$business->getDeals(['name' => 'Название вашей созданной сделки вручную','with_additional_fields'=>1]);
```
Вывев результат вы найдете всё вас интересующее

****Прочие методы и классы которые будут полезны****

```
$business->newPartnerContactInfo($array,$partnerid);
```
Функия если вам нужно создать контакту новые контактные данные,  
 но не создаватьсамого партнера, 
 * 1ый параметр массив с данными(id указаны выше)
 * 2ой параметр партнер ID - необязательный параметр если ранее была вызвана функция setPartnerId() ; 
 
```
$business->setPartnerId(id)
```
Установить новый партнер ID - 
* 1 параметр ID.


```
$business->getPartnerId()
```
Получить партнер ID

```
$business->getDeals($options)
```
Получить все сделки или определенную (если передать в  опшонс параметры)
* 1 параметр  - массив с опциями.

```
$business->getPartners($options)
```
Получить всех партнеров или определенного (если передать в  опшонс параметры)
* 1 параметр  - массив с опциями.

```
$business->getContactInfo($options)
```
Получить информацию о контакте с данными 
* 1 параметр  - массив с опциями обязательно
